/*
Plugin Name: France regions HTML 5 map
Plugin URI: http://cmap.comersis.com/
Description: France regions map.
Version: france-free-1.032
Author: S.Marmion
Author URI: http://www.cmap.comersis.com
License: non-comercial
*/

// MAP CONFIG  ///////////////////////////////////////////////////////////////////////

var mapcolor = "#70ABF3";			// couleur de fond de carte
var mapcolor_hover = "#FF0000";		// couleur de survol de la souris
var maplines = "#FFFFFF";			// couleur des traits de séparation des régions

//


// MAP LINKS  ///////////////////////////////////////////////////////////////////////

var paths = {
               R0: {
                  title: "Paris",
                  url: "file:///android_asset/images/paris.jpg",
                  path: "620,400,620,375,610,365,610,350,570,350,550,360,550,370,530,365,515,380,515,395,535,395,535,400,540,405,540,405,545,405,560,410,575,415,585,420,595,415,610,410,620,410,635,415,640,415,650,410,650,400,645,395,635,395"
               },
               R1: {
                  title: "Haut de Seine",
                  url: "file:///android_asset/images/hautdeseine.png",
                  path: "570,350,570,340,580,330,580,320,565,315,545,310,520,330,505,345,485,350,475,375,480,385,475,385,480,390,480,395,475,395,475,400,475,405,475,420,490,420,495,435,505,435,510,440,510,445,515,445,520,450,515,455,520,450,520,460,530,465,540,465,550,475,545,480,545,485,560,480,560,485,565,485,570,475,565,470,570,450,570,435,570,430,570,430,575,415,555,415,545,405,540,410,540,405,530,405,530,395,515,395,515,380,530,365,550,370,550,360"
               },
               R2: {
                  title: "Seine saint Denis",
                  url: "file:///android_asset/images/seinestdenis.jpg",
                  path: "620,395,620,375,610,365,610,355,570,355,570,340,580,330,580,325,565,315,550,315,550,305,555,300,575,310,580,300,590,300,590,295,605,295,615,310,630,305,640,310,655,305,670,295,675,290,675,280,685,270,695,270,695,265,705,270,710,275,710,285,710,290,700,290,715,310,720,315,720,325,720,325,720,330,715,335,715,340,715,350,715,360,705,360,700,365,705,370,705,380,715,380,710,395,715,415,720,425,715,430,705,420,705,415,700,410,685,400,675,390,660,385,650,385,635,395,620,395"
               },
               R3: {
                  title: "Val-de-Marne",
                  url: "file:///android_asset/images/valdemarne.jpg",
                  path: "570,475,565,470,570,450,570,435,570,435,570,430,575,420,595,420,610,410,635,415,650,410,650,405,650,400,640,395,630,395,625,400,620,395,640,390,650,385,650,385,665,385,685,395,700,410,710,425,715,425,720,435,720,440,715,450,715,455,730,455,730,465,720,465,720,470,720,470,715,480,720,485,720,485,705,505,705,510,710,515,705,520,695,520,690,510,680,510,675,495,675,490,670,485,640,495,635,490,620,495,615,490,610,495,595,495,595,475,575,480"
               },
               R4: {
                  title: "Essone",
                  url: "file:///android_asset/images/essonne.png",
                  path: "705,520,695,520,685,510,680,510,675,490,670,485,640,495,635,495,620,495,615,490,605,495,595,495,595,475,575,480,570,480,565,490,555,485,555,480,540,490,540,480,550,475,540,465,525,465,520,455,505,460,500,455,495,455,500,470,495,470,485,465,480,475,475,470,470,480,465,485,445,485,445,485,455,495,450,505,445,515,440,515,440,525,430,520,425,525,415,525,415,530,410,530,405,550,400,545,400,555,400,560,410,560,410,565,420,575,425,580,420,585,410,590,410,600,400,620,400,625,380,630,375,625,355,625,355,635,365,640,370,645,380,645,380,655,370,655,360,665,355,675,355,690,350,690,345,700,350,705,355,710,355,720,360,720,360,735,350,740,355,750,380,750,375,765,380,770,380,775,385,780,380,790,375,795,375,800,380,810,380,815,380,820,380,820,370,825,370,835,380,835,380,840,400,840,410,840,415,845,420,840,420,835,440,835,445,830,450,825,455,825,455,835,480,835,475,820,485,820,485,820,490,825,495,820,490,815,495,810,495,805,505,800,505,795,510,805,515,800,520,805,525,805,530,810,520,820,530,820,530,835,540,820,555,825,565,810,570,805,575,810,580,815,590,825,595,825,610,820,615,815,605,805,615,805,620,805,630,800,625,800,625,790,635,790,635,785,630,780,635,775,640,780,640,770,650,770,655,765,650,760,660,755,670,755,680,750,690,750,675,730,670,730,670,725,665,720,670,710,665,705,665,705,665,685,675,675,670,660,665,660,665,645,670,640,665,640,675,625,675,605,685,600,690,585,680,580,680,575,675,570,690,565,685,560,695,555,685,550,690,540,695,535,700,540,705,540,705,535,710,530,710,525"
               },
               R5: {
                  title: "Yvelines",
                  url: "file:///android_asset/images/yvelines.png",
                  path: "350,705,350,700,350,690,355,690,355,675,370,655,380,650,380,645,375,645,365,635,360,640,355,635,360,625,375,625,380,630,400,625,400,615,415,600,410,590,420,585,425,580,410,565,410,560,405,560,400,555,400,545,405,550,410,530,415,530,420,525,430,525,430,520,435,525,440,515,445,515,455,500,445,485,450,480,470,485,470,475,475,470,480,475,490,465,495,470,500,460,495,455,500,450,510,460,515,455,520,445,515,445,510,445,505,435,495,435,490,420,475,425,475,410,475,405,475,400,480,395,475,385,475,380,475,375,485,350,505,345,505,315,490,310,490,295,485,285,475,285,460,280,460,260,450,270,440,260,435,270,425,270,415,275,405,275,390,255,360,255,345,240,345,235,330,250,330,260,320,265,310,245,315,240,320,230,305,225,300,215,280,215,285,225,280,230,270,230,260,225,255,235,250,235,240,240,225,230,225,220,210,215,190,210,185,215,180,210,180,205,160,210,155,220,145,215,135,215,125,205,125,225,110,235,100,225,90,230,90,235,95,245,95,250,105,260,105,265,110,270,110,275,105,275,105,280,100,285,105,295,110,290,120,295,125,285,125,295,115,300,115,305,115,310,120,310,125,310,120,325,125,325,125,340,130,335,140,335,140,345,140,350,155,360,145,375,150,380,155,380,165,385,160,395,175,400,175,405,165,410,170,425,165,425,160,445,165,455,165,465,180,465,185,475,185,485,170,505,170,505,160,510,165,520,180,525,180,535,175,540,185,555,200,550,195,555,200,560,200,565,205,570,205,575,210,580,220,575,220,585,240,580,240,595,230,605,240,615,250,615,255,610,260,615,270,630,280,630,270,645,270,670,280,675,275,680,280,685,280,690,285,695,285,700,305,700,305,715,315,715,320,720,335,720,340,725,340,720,350,715,350,700"
               },
               R6: {
                  title: "Val d'Oise",
                  url: "file:///android_asset/images/valdoise.jpg",
                  path: "690,250,690,260,695,260,695,265,695,270,685,270,680,280,680,285,645,305,615,305,605,295,595,295,590,300,580,300,580,305,555,300,555,310,525,330,505,345,505,310,490,305,490,295,480,280,465,280,460,255,450,265,440,255,435,265,425,265,420,270,405,275,390,255,360,250,345,240,345,230,330,245,330,255,320,260,315,245,320,230,315,220,310,220,300,210,280,215,285,220,280,230,270,225,265,220,260,235,245,235,240,235,225,225,230,220,215,215,190,210,185,215,180,210,190,205,190,200,185,195,190,190,190,185,200,180,200,175,205,170,205,165,205,155,210,150,210,145,210,140,215,100,230,90,235,80,240,85,250,90,250,95,250,105,240,110,240,110,245,110,245,115,250,115,260,135,275,125,280,125,285,125,290,130,290,135,300,130,305,130,305,140,315,135,315,140,325,135,335,140,355,135,360,135,370,135,380,125,390,130,400,135,405,120,415,120,420,110,435,110,440,105,440,110,445,105,445,120,455,120,460,125,465,120,470,120,470,130,475,120,485,125,485,140,490,140,490,135,505,135,510,125,520,135,515,145,520,150,530,150,540,145,550,145,550,140,560,135,560,125,570,125,585,145,590,150,595,155,595,145,600,145,610,150,635,155,635,165,645,160,650,165,660,170,670,175,665,185,665,190,675,190,685,190,685,175,695,180,700,175,700,190,705,200,710,200,710,205,715,210,705,225,710,230,715,225,715,235,705,240,705,250,695,255,690,255"
               },
               R8: {
                  title: "Seine et Marne",
                  url: "file:///android_asset/images/seineetmarne.jpg",
                  path: "715,210,705,225,715,225,715,235,705,240,705,250,685,250,690,260,695,260,695,265,705,270,710,280,710,285,700,285,720,325,715,335,715,355,700,360,705,380,715,380,710,390,720,425,720,425,720,435,720,440,715,450,715,455,725,450,730,460,720,465,720,470,715,475,720,480,705,505,705,510,710,510,705,515,715,525,705,530,705,540,700,530,695,535,690,535,685,545,695,550,690,565,675,565,680,575,680,580,690,580,690,595,680,605,675,620,665,635,670,635,670,640,670,645,670,655,675,665,675,680,670,685,670,700,670,720,670,725,690,750,670,755,665,750,650,760,660,765,650,770,640,770,630,780,635,785,635,790,630,790,630,795,630,800,605,805,615,815,625,830,625,860,640,870,650,865,655,870,655,875,670,875,670,885,675,885,680,910,670,925,675,930,675,940,670,945,660,935,655,945,650,945,650,950,650,950,645,955,635,965,640,970,650,965,680,970,685,955,705,955,710,965,725,965,745,960,755,970,765,970,780,970,790,960,805,955,805,945,800,935,815,935,835,935,835,940,830,945,830,965,840,965,845,960,850,960,870,945,905,935,905,925,915,915,925,915,925,905,945,900,945,895,950,885,950,880,960,880,960,870,970,870,965,855,955,850,960,840,950,835,960,830,950,825,965,805,960,800,970,780,975,785,990,785,995,790,1005,775,1010,775,1015,770,1020,775,1030,775,1035,765,1040,770,1045,775,1045,775,1050,780,1060,775,1075,775,1080,775,1085,770,1100,765,1100,770,1105,765,1110,770,1110,770,1130,770,1135,765,1140,770,1140,755,1145,755,1150,750,1170,760,1170,750,1170,740,1165,735,1165,730,1160,730,1155,720,1165,715,1160,700,1155,700,1160,695,1150,685,1180,670,1165,645,1170,640,1180,645,1190,645,1205,630,1200,625,1200,620,1195,610,1205,605,1210,600,1225,600,1215,585,1235,585,1240,580,1250,575,1230,565,1225,565,1225,560,1230,555,1215,555,1210,550,1200,560,1190,560,1190,555,1195,545,1180,540,1185,530,1200,520,1200,510,1195,505,1200,480,1180,480,1175,465,1170,465,1160,470,1160,455,1165,445,1175,445,1175,445,1185,445,1180,425,1170,430,1165,425,1170,415,1175,420,1190,425,1195,415,1200,415,1205,420,1210,420,1205,390,1200,390,1195,400,1185,395,1185,385,1175,385,1170,375,1160,380,1165,370,1155,370,1155,375,1150,375,1150,360,1140,355,1145,345,1145,330,1135,340,1130,340,1125,345,1110,335,1110,320,1105,310,1095,320,1085,320,1080,310,1075,290,1065,290,1065,280,1055,275,1050,265,1030,260,1030,255,1040,245,1040,235,1045,235,1045,235,1045,230,1040,230,1040,220,1025,205,1030,190,1020,190,1015,185,1000,185,980,180,970,190,975,205,940,205,935,215,930,215,925,210,925,200,915,205,910,205,910,210,905,205,895,210,885,205,885,210,875,210,870,215,860,215,855,205,845,205,835,195,820,205,820,205,815,205,825,210,805,225,795,225,790,205,780,220,770,220,775,210,755,190,745,190,740,185,735,195,725,200,725,205,715,210"
               }
            }

var departement = ["Paris", "Haut de Seine", "Seine saint Denis", "Val-de-Marne", "Essonne", "Yvelines", "Val d'Oise", "Seine et Marne"];

var random;

function francefree(){
random = departement[Math.floor(Math.random() * departement.length)];

var cmap = '';
cmap += '<link rel="stylesheet" href="cmap/style.css" type="text/css" media="screen" />';
cmap += '<script src="cmap/jquery-1.11.1.min.js"></script>';
cmap += '<script src="cmap/region.js"></script>';
cmap += '<map  name="map"><div id="areas"></div> </map><img id="canvasMap" id="image" src="cmap/trans.gif" usemap="#map"/>';
cmap += '<canvas id="canvas"></canvas><div id="container"><div id="question">Situez la region "' + random + '"</div>';
cmap += '<div> <div id="erreur"></div> <div id="buttonDiv"></div> </div></div>';

document.write(""+cmap+"");
}
$(function(){
        var map = $("#map");
        var areas = $("#areas");
        var canvas = $("#canvas")[0];
		canvas.width = 1200;
        canvas.height = 1200;
        var c = canvas.getContext("2d");
        $.fn.render = function(){
          this.data.apply(this, arguments);
          render();
        }
        function clear(){
          c.fillStyle = "#FFFFFF";
          c.fillRect(0, 0, canvas.width, canvas.height);
        }
	arr = new Array();
    for (var country in paths) {
        var obj = paths[country].path;
		var lnk = paths[country].url;
		var txt = paths[country].title;
        $('<area />', {
          shape : "poly",
          coords : ""+obj+"",
          alt : ""+txt+""
        }).data({
          fillStyle: mapcolor,
          strokeStyle : maplines,
          lineWidth : 1.2,
		  alt : ""+txt+"",
		  link: lnk
        }).mouseenter(function(){
          $(this).render({strokeStyle: maplines,
                          fillStyle : mapcolor_hover});
        //  $("div#legende").html(""+this.alt+"");
		 render();
        }).mouseleave(function(){
          $(this).render({strokeStyle: maplines,
                          fillStyle : mapcolor});
		$("div#legende").html("");
        }).click(function(){
            var link = $(this).data("link");
            var clicked = $(this).attr("alt");
            if(clicked == random) {
                var btn = $("<input />", {
                    id: "button",
                    type: "button",
                    value: "Next Question",
                    });
                $("div#buttonDiv").html(btn);
                $("div#erreur").html("Bonne Reponse! tu es trop fort");
                $("#button").click(function() {
                    window.location = link;
                });
            } else {
                $("div#erreur").html("Faux! ceci est le departement:\n" + clicked);
            }


        }).appendTo(areas);
        render();
}
        function fillStroke(fillStyle, strokeStyle){
          if (fillStyle) c.fill();
          if (strokeStyle) c.stroke();
        }
        function render(noClear){
          if (!noClear){
            clear();
          }
          areas.children().each(function(i){
            var area = $(this);
            var shape = area.attr("shape");
            var coords = area.attr("coords").split(",");
            var fillStyle = area.data("fillStyle");
            var strokeStyle = area.data("strokeStyle");
            var lineWidth = area.data("lineWidth");
              if (fillStyle){
                c.fillStyle = fillStyle;
              }
              if (strokeStyle){
                if (lineWidth){
                  c.lineWidth = lineWidth;
                }
                c.strokeStyle = strokeStyle;
              }
              c.beginPath();
              var leng = coords.length;
              c.moveTo(coords[0], coords[1]);
              for (var i = 2; i < leng; i+=2){
                c.lineTo(coords[i], coords[i+1]);
              }
              c.closePath();
              fillStroke(fillStyle, strokeStyle);
            c.lineWidth = 1;
          });
        }
      });
